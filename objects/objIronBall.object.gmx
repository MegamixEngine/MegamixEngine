<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sprIronBall</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>prtBoss</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();

healthpointsStart = 28;
healthpoints = healthpointsStart;
imageOffset = 0;
contactDamage = 3;
customPose = true;
ground = false;
grav = 0.10;
spd = 1.5;
phase = 0;
shotsFired = 0;
attackTimer = 0;
healthBarPrimaryColor[1] = 18;
healthBarSecondaryColor[1] = 40;
hasTriggeredFall = false;
bounces = 0;

laserSpeed = 2;

yStore = choose(1, -1);

// Music
music = "WilyTowerBossTheme.vgm";
musicType = "VGM";
musicTrackNumber = 0;

// Damage Tables
enemyDamageValue(objBusterShot, 1);
enemyDamageValue(objBusterShotHalfCharged, 1);
enemyDamageValue(objBusterShotCharged, 3);

// MaGMML3
enemyDamageValue(objSparkChaser, 2);
enemyDamageValue(objLaserTrident, 2);
enemyDamageValue(objWaterShield, 1);
enemyDamageValue(objTornadoBlow, 1);
enemyDamageValue(objThunderBeam, 4);
enemyDamageValue(objBreakDash, 1);
enemyDamageValue(objMagneticShockwave, 2);
enemyDamageValue(objIceWall, 1);

// MaGMML2
enemyDamageValue(objHornetChaser, 2);
enemyDamageValue(objJewelSatellite, 1);
enemyDamageValue(objGrabBuster, 4);
enemyDamageValue(objTripleBlade, 0);
enemyDamageValue(objWheelCutter, 0);
enemyDamageValue(objSlashClaw, 2);
enemyDamageValue(objSakugarne, 0);
enemyDamageValue(objSuperArrow, 2);
enemyDamageValue(objWireAdapter, 1);

// MaGMML1
enemyDamageValue(objMetalBlade, 1);
enemyDamageValue(objGeminiLaser, 2);
enemyDamageValue(objSolarBlaze, 1);
enemyDamageValue(objTopSpin, 0);
enemyDamageValue(objThunderWool, 4);
enemyDamageValue(objPharaohShot, 1);
enemyDamageValue(objBlackHoleBomb, 1);
enemyDamageValue(objMagicCard, 2);

// MaG48HMML
enemyDamageValue(objFlameMixer, 2);
enemyDamageValue(objRainFlush, 2);
enemyDamageValue(objSparkShock, 4);
enemyDamageValue(objSearchSnake, 1);
enemyDamageValue(objTenguBlade, 1);
enemyDamageValue(objTenguDash, 1);
enemyDamageValue(objTenguDisk, 2);
enemyDamageValue(objSaltWater, 2);
enemyDamageValue(objConcreteShot, 1);
enemyDamageValue(objHomingSniper, 2);

// MaG24HMML
enemyDamageValue(objSuperArmBlockProjectile, 1);
enemyDamageValue(objSuperArmDebris, 1);
enemyDamageValue(objChillShot, 1);
enemyDamageValue(objChillSpikeLanded, 1);

// Misc.
enemyDamageValue(objPowerStone, 4);
enemyDamageValue(objPlantBarrier, 1);
enemyDamageValue(objBrickWeapon, 1);
enemyDamageValue(objIceSlasher, 1);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// leave this. this is needed.
event_inherited();

// all of iron balls's events trigger when the game isn't frozen.
if (entityCanStep())
{
    // iron balls's custom intro
    if (startIntro)
    {
        calibrateDirection();
        y -= view_hview;
        canFillHealthBar = false;
        image_index = 0;
        startIntro = false;
        isIntro = true;
        visible = true;
    }
    else if (isIntro)
    {
        // custom intro:
        if (y &lt;= ystart &amp;&amp; !hasTriggeredFall)
        {
            y += 4;
        }
        if (y &gt;= ystart || hasTriggeredFall)
        {
            hasTriggeredFall = true;
            blockCollision = blockCollisionStart;
            grav = gravStart;
            if (y &gt;= ystart &amp;&amp; yspeed &gt;= 0)
            {
                shotsFired++;
                yspeed = -3;
                playSFX(sfxTeckyun);
            }
            
            if (shotsFired &gt;= 3)
            {
                canFillHealthBar = true;
                shotsFired = 0;
                attackTimer = 0;
                isIntro = false;
            }
        }
    }
}
if (entityCanStep())
{
    with (objGeminiManLaser) // this code delays the gemini laser for a few frames, so it gives the long laser effect.
    {
        if (bounces &lt; 0)
        {
            x = xstart;
            y = ystart;
            bounces += other.laserSpeed / 2;
        }
        if (bounces &gt;= 3) // since gemini laser dont disable themselves, do it here.
        {
            blockCollision = 0;
        }
    }
    if (isFight)
    {
        attackTimer += 1;
        switch (phase)
        {
            case 0: // bounce around 
                if (healthpoints &lt;= healthpointsStart / 2) // change phases!
                {
                    attackTimer = 0;
                    phase = 2;
                }
                if (image_index &gt; 0)
                {
                    image_index -= 0.125;
                }
                grav = 0.25;
                if (xspeed == 0) // force speed to happen in case it ever gets reset to 0.
                {
                    xspeed = spd * image_xscale;
                }
                if (ground) // jump
                {
                    yspeed = -6 + irandom(4) / 2;
                    playSFX(sfxTeckyun);
                    shotsFired += 1 + choose(0, 0, 0, 0, 0, 1, 1, 2); // sometimes iron ball will jump fewer than 3 times, this is determined randomly.
                }
                if (xcoll != 0)
                {
                    image_xscale *= -1;
                    xspeed *= -1;
                    playSFX(sfxTeckyun);
                }
                if (shotsFired &gt;= 3 &amp;&amp; yspeed &gt;= 0 &amp;&amp; !ground) // after 3 (or fewer) jumps, change phases
                {
                    shotsFired = 0;
                    attackTimer = 0;
                    xspeed = 0;
                    yspeed = 0;
                    grav = 0;
                    phase = 1;
                    if (spd &gt; 3)
                    {
                        spd = 1.5;
                    }
                }
                break;
            case 1: // shoot gemini lasers 
                if (instance_exists(objGeminiManLaser) &amp;&amp; shotsFired == 0)
                {
                    shotsFired = 1;
                }
                if (image_index &lt; 2)
                {
                    image_index += 0.125;
                }
                else if (shotsFired == 0 &amp;&amp; (!instance_exists(objGeminiManLaser) || (global.difficulty == DIFF_HARD)) &amp;&amp; attackTimer &gt; 24) // only fire gemini lasers if none exists
                {
                    shotsFired = 1;
                    var sideShot = choose(0, 1, 2, 3);
                    playSFX(sfxGeminiLaser);
                    
                    
                    for (var i = 0; i &lt; 2 + (global.difficulty == DIFF_HARD); i++)
                    {
                        for (var j = -laserSpeed * 3; j &lt; 0; j += laserSpeed)
                        {
                            switch (sideShot) // vary laser shot and direction depending on randomly chosen side
                            {
                                case 0:
                                case 4:
                                    with (instance_create(x + 12, y - 16, objGeminiManLaser))
                                    {
                                        xspeed = other.laserSpeed;
                                        yspeed = -other.laserSpeed;
                                        bounces = j; // "bounce" variable is used as a sort of timer to delay the gemini laser with code above.
                                    }
                                    break;
                                case 1:
                                    with (instance_create(x + 12, y + 8, objGeminiManLaser))
                                    {
                                        xspeed = other.laserSpeed;
                                        yspeed = other.laserSpeed;
                                        bounces = j;
                                    }
                                    break;
                                case 2:
                                    with (instance_create(x - 12, y + 8, objGeminiManLaser))
                                    {
                                        xspeed = -other.laserSpeed;
                                        yspeed = other.laserSpeed;
                                        bounces = j;
                                    }
                                    break;
                                case 3:
                                    with (instance_create(x - 12, y - 16, objGeminiManLaser))
                                    {
                                        xspeed = -other.laserSpeed;
                                        yspeed = -other.laserSpeed;
                                        bounces = j;
                                    }
                                    break;
                            }
                        }
                        with (objGeminiManLaser) // setup initial gemini laser state for each created.
                        {
                            instance_create(x, y, objExplosion);
                            sprite_index = sprGeminiLaserReflect;
                            image_xscale = sign(xspeed);
                            image_yscale = sign(yspeed);
                        }
                        var oldShot = sideShot;
                        while (sideShot == oldShot)
                        {
                            sideShot = choose(0, 1, 2, 3);
                        }
                    }
                }
                if (attackTimer == 70) // reset to phase 0
                {
                    attackTimer = 0;
                    phase = 0;
                }
                break;
            case 2: // move towards middle 
                xspeed = 0;
                yspeed = 0;
                grav = 0;
                spd = 1;
                mp_linear_step(view_xview + view_wview / 2, view_yview + view_hview / 2, spd, false);
                
                // when middle is reached, change animation.
                if (x &gt;= (view_xview + view_wview / 2) - 1 &amp;&amp; x &lt;= (view_xview + view_wview / 2) + 1 &amp;&amp; y &gt;= (view_yview + view_hview / 2) - 1 &amp;&amp; y &lt;= (view_yview + view_hview / 2) + 1)
                {
                    x = (view_xview + view_wview / 2);
                    y = (view_yview + view_hview / 2);
                    image_index = 3;
                    
                    if (attackTimer &gt;= 64)
                    {
                        image_index = 4;
                        attackTimer = 0;
                        phase = 3;
                    }
                }
                else
                {
                    attackTimer = 0;
                    if (image_index &gt; 0)
                    {
                        image_index -= 0.125;
                    }
                }
                break;
            case 3: // bounce around room 
                {
                    if (abs(xspeed) != spd)
                    {
                        xspeed = spd * image_xscale;
                    }
                    if (abs(yspeed) != spd)
                    {
                        yspeed = spd * yStore;
                    }
                    
                    // rebounce around room
                    if (xcoll != 0)
                    {
                        xspeed *= -1;
                        image_xscale *= -1;
                        playSFX(sfxTeckyun);
                    }
                    
                    if (spd &gt; 4.5)
                    {
                        spd = 4.5;
                    }
                    
                    if (ycoll != 0)
                    {
                        yspeed *= -1;
                        yStore *= -1;
                        playSFX(sfxTeckyun);
                    }
                    
                    if (attackTimer == 120) // fire bomber pepe's egg of all things
                    {
                        // Vary dropped object based on difficulty
                        var objectToDrop;
                        
                        if (global.difficulty == DIFF_HARD)
                        {
                            objectToDrop = objPipiEgg;
                        }
                        else
                        {
                            objectToDrop = objBomberPepeEgg;
                        }
                        
                        with (instance_create(x, y, objectToDrop))
                        {
                            itemDrop = -1;
                            playSFX(sfxEnemyDrop);
                            
                            if (objectToDrop == objBomberPepeEgg)
                            {
                                if (instance_exists(target))
                                {
                                    xspeed = sign(x - target.x) * 2; // find mega man
                                }
                                else
                                {
                                    xspeed = image_xscale * 2;
                                }
                            }
                        }
                        attackTimer = 0;
                    }
                }
        }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="21">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();
if (image_index &lt; 2 || image_index == 3)
{
    other.guardCancel = 3;
}
else
    spd += 0.25;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="20">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>with (objGeminiManLaser)
    instance_destroy();
with (objBomberPepeEgg)
{
    instance_create(x, y, objExplosion);
    instance_destroy();
}
with (objHarmfulExplosion)
    instance_destroy();
event_inherited();
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>

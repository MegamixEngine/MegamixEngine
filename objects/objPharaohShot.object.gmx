<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>sprPharaohShotCharging</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>prtPlayerProjectile</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();

bulletLimitCost = 1;

contactDamage = 1;
inWater = -1;

penetrate = 0;
pierces = 0;

attackDelay = 16;

timer = 0;
charging = true;
extraDamage = 0;

despawnRange = 48; // don't die when going above the screen ;_;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();

var ammo = global.ammo[playerID, global.weapon[playerID]];
if (ammo &lt;= 0 &amp;&amp; charging)
{
    instance_destroy();
    exit;
}

if (!global.frozen)
{
    if (charging)
    {
        if (instance_exists(parent)) // Set position to above the player's head
        {
            x = parent.x + parent.image_xscale;
            y = parent.y - (20 * sign(image_yscale));
            image_yscale = parent.image_yscale;
        }
        else
        {
            instance_destroy();
        }
        
        timer += 1; // initialization timer
        if (timer &lt; 10) // pause for charge
        {
            canHit = false;
            canDamage = 0;
        }
        else
        {
            canHit = true;
            canDamage = 1;
            if (ammo &gt;= 2)
            {
                image_speed = 1 / 7;
                if (ammo == 2 &amp;&amp; floor(image_index) &gt; 6)
                    image_index = 5;
                if (sprite_index == sprPharaohShotCharging) // After fully charging, change sprites
                {
                    if (floor(image_index) &gt; 9)
                    {
                        sprite_index = sprPharaohShotCharged;
                        pierces = 1;
                        extraDamage = 4;
                        cost = 3;
                    }
                }
            }
        }
        
        if (instance_exists(parent))
        {
            var canShoot = false;
            with (parent)
            {
                canShoot = !playerIsLocked(PL_LOCK_SHOOT);
            }
            
            if (!global.keyShoot[parent.playerID] &amp;&amp; canShoot) // LET GO OF CHARGE AND SHOOT
            {
                canDamage = true;
                var xs = 16;
                if (!parent.ground &amp;&amp; (parent.isShoot &lt; 3))
                {
                    xs -= 5;
                }
                x = parent.x + (xs) * parent.image_xscale;
                y = parent.y + 4 * parent.image_yscale;
                parent.shootTimer = 0;
                parent.isShoot = 2;
                
                charging = false;
                
                var cost;
                
                if (sprite_index == sprPharaohShotCharging)
                {
                    playSFX(sfxPharaohShot);
                    sprite_index = sprPharaohShot;
                    cost = 1;
                }
                else
                {
                    playSFX(sfxPharaohShotCharged);
                    image_speed = (1 / 7);
                    bulletLimitCost = 3;
                    pierces = 1;
                    cost = 3;
                }
                
                if (global.ammo[playerID, global.weapon[playerID]] &gt; 0)
                {
                    global.ammo[playerID, global.weapon[playerID]] -= (cost / (global.energySaver + 1));
                }
                
                // Set speed regardless of charge level
                xspeed = parent.image_xscale * 4.5;
                yspeed = 4.5 * (-global.keyUp[parent.playerID] + global.keyDown[parent.playerID]) * sign(image_yscale);
            }
        }
    }
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="24">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (global.keyShoot[playerID] &amp;&amp; !playerIsLocked(PL_LOCK_SHOOT)
&amp;&amp; global.ammo[playerID, global.weapon[playerID]] &gt; 0)
{
    fireWeapon(0, 0, objPharaohShot, 2, 0, 0, 0);
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="22">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>weaponSetup("PHARAOH SHOT", make_color_rgb(252, 116, 96), make_color_rgb(252, 188, 176), sprWeaponIconsPharaohShot);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="18">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>event_inherited();

// depend ammo count on current state
var cost;

if (sprite_index == sprPharaohShotCharging)
{
    cost = 1;
}
else
{
    cost = 3;
}

if (charging)
{
    if (global.ammo[playerID, global.weapon[playerID]] &gt; 0)
    {
        global.ammo[playerID, global.weapon[playerID]] -= (cost / (global.energySaver + 1));
    }
}

// Charged Pharaoh Shots only do two extra points of damage to bosses unless specified
// in their User Event 11 code
if (object_is_ancestor(other,prtBoss))
{
    if(sprite_index = sprPharaohShotCharged)
        extraDamage = 2;
}

global.damage += extraDamage;



</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="17">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (charging)
{
    playSFX(sfxReflect);
    instance_destroy();
}
else
{
    event_inherited();
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
